---
layout: post
date: 2016-03-14
author: gstefanick
categories: wifi
---
<div id="content">
<h1 class="title">WiFi案例6 &#x2013; 客户报怨传输高分辨率的图片时很慢</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">问题描述</a></li>
<li><a href="#sec-2">问题分析</a></li>
<li><a href="#sec-3">解决方法</a></li>
</ul>
</div>
</div>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">问题描述</h2>
<div class="outline-text-2" id="text-1">
<p>
客户报怨他们新的网卡传输高分辨率的图片时，速率非常慢。然而，在上星期
的售前演示时，却没有这样的问题。
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">问题分析</h2>
<div class="outline-text-2" id="text-2">
<p>
抓取数据包如下：
</p>


<div class="figure">
<p><img src="/images/2016/2016031406.png" alt="2016031406.png" />
</p>
</div>

<p>
发现上述情况不断重复，即不停地进行Off-Channel扫描，然而网卡没有动，
且非常靠近AP。 
</p>

<p>
<code>一个设备在off-channel或休眠状态下是不会传输数据的。</code> NULL数据帧使用
power management位来通知AP为其缓存数据帧。 通常有如下两种原因：
</p>
<ol class="org-ol">
<li>节省电力
</li>
<li>执行off-channel扫描来建立一个neighbor列表,以方便未来可能进行的漫
游动作。
</li>
</ol>

<p>
在这个案例中，STA不停地尝试建立一个neighbor列表，可以看到它在正执行
off-channel扫描（在信息1,6,11之间不停地切换）。这表明STA正在尝试寻找
一个更好的AP去关联，有如下可能的原因会导致这种行为发生：
</p>
<ol class="org-ol">
<li>driver有错误。
</li>
<li>STA错误地配置了高概率的漫游。
</li>
<li>RF差，没有接收到数据。
</li>
<li>天线坏了或者是没有接好。
</li>
<li>干涉。
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">解决方法</h2>
<div class="outline-text-2" id="text-3">
<p>
基于上述的分析以及可能的原因，发现USB接口的网卡插在显示器的背部，周
围几乎被金属包围。这样会导致USB性能很差，很能保持连接，会导致不停地
漫游到新的AP上。
<img src="/images/2016/2016031401.jpg" alt="2016031401.jpg" />
</p>
</div>
</div>
</div>
